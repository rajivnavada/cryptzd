syntax = "proto3";
package crypto_pb;

message CredentialOperation {

    enum Command {
        GET = 0;
        SET = 1; // Even updates can be handled via ADD
        DELETE = 2;
    }

    Command command = 1;
    int32 project = 2;
    string key = 3;
    string value = 4;

}

message ProjectOperation {

    enum Command {
        LIST = 0;
        CREATE = 1;
        UPDATE = 2;
        DELETE = 3;
        LIST_CREDENTIALS = 4;
        ADD_MEMBER = 5;
        DELETE_MEMBER = 6;
    }

    Command command = 1;
    string name = 2;
    string environment = 3;
    int32 projectId = 4; // Either name-environment combo or projectId will be required
    int32 memberId = 5;
    int32 userId = 6;
    string accessLevel = 7;
    string memberEmail = 8;

}

message Operation {
    int32 opId = 1;

    oneof ProjectOrCredentialOp {
        ProjectOperation projectOp = 2;
        CredentialOperation credentialOp = 3;
    }
}

message Credential {
    int32 id = 1;
    string key = 2;
    string cipher = 3;
}

message Project {
    int32 id = 1;
    string name = 2;
    string environment = 3;
}

message ProjectOperationResponse {
    ProjectOperation.Command command = 1;
    Project project = 2;
    int32 memberId = 3;
    repeated Credential credentials = 4;
    repeated Project projects = 5;
}

message CredentialOperationResponse {
    CredentialOperation.Command command = 1;
    Credential credential = 2;
}

message Response {
    enum Status {
        ERROR = 0;
        SUCCESS = 1;
    }

    Status status = 1;
    string error = 2;
    string info = 3;
    int32 opId = 4;

    oneof ProjectOrCredentialResponse {
        ProjectOperationResponse projectOpResponse = 5;
        CredentialOperationResponse credentialOpResponse = 6;
    }
}
